package spoj.dynamic_programming.slikar;

// http://www.spoj.com/problems/SLIKAR/

public class SLIKAR_1 {

	public static void main(String... args) {
		System.out.println(solve(new String[]{
				"01010001",
				"10100011",
				"01010111",
				"10101111",
				"01010111",
				"10100011",
				"01010001",
				"10100000",
		}));

		System.out.println();
		System.out.println(solve(new String[]{
				"0101000101010001",
				"1010001101010001",
				"0101011101010001",
				"1010111101010001",
				"0101011101010001",
				"1010001101010001",
				"0101000101010001",
				"1010000010100000",
				"0101000101010001",
				"1010001101010001",
				"0101011101010001",
				"1010111101010001",
				"0101011101010001",
				"1010001101010001",
				"0101000101010001",
				"1010000010100000",
		}));

		System.out.println();
		System.out.println(solve(new String[]{
				"01010001010100011111111100010001",
				"10100011010100011111111100010001",
				"01010111010100011111111100010001",
				"10101111010100011111111100010001",
				"01010111010100011111111100010001",
				"10100011010100011111111100010001",
				"01010001010100011111111100010001",
				"10100000101000001111111100010001",
				"01010001010100011111111100010001",
				"10100011010100011111111100010001",
				"01010111010100011111111100010001",
				"10101111010100011111111100010001",
				"01010111010100011111111100010001",
				"10100011010100011111111100010001",
				"01010001010100011111111100010001",
				"10100000101000001111111100010001",
				"01010001010100011111111100010001",
				"10100011010100011111111100010001",
				"01010111010100011111111100010001",
				"10101111010100011111111100010001",
				"01010111010100011111111100010001",
				"10100011010100011111111100010001",
				"01010001010100011111111100010001",
				"10100000101000001111111100010001",
				"01010001010100011111111100010001",
				"10100011010100011111111100010001",
				"01010111010100011111111100010001",
				"10101111010100011111111100010001",
				"01010111010100011111111100010001",
				"10100011010100011111111100010001",
				"01010001010100011111111100010001",
				"10100000101000001111111100010001",
		}));

		System.out.println();
		System.out.println(solve(new String[]{
				"0101000101010001111111110001000100001111000000001111111111111111",
				"1010001101010001111111110001000100001111000000001111111111111111",
				"0101011101010001111111110001000100001111000000001111111111111111",
				"1010111101010001111111110001000100001111000000001111111111111111",
				"0101011101010001111111110001000100001111000000001111111111111111",
				"1010001101010001111111110001000100001111000000001111111111111111",
				"0101000101010001111111110001000100001111000000001111111111111111",
				"1010000010100000111111110001000100001111000000001111111111111111",
				"0101000101010001111111110001000100001111000000001111111111111111",
				"1010001101010001111111110001000100001111000000001111111111111111",
				"0101011101010001111111110001000100001111000000001111111111111111",
				"1010111101010001111111110001000100001111000000001111111111111111",
				"0101011101010001111111110001000100001111000000001111111111111111",
				"1010001101010001111111110001000100001111000000001111111111111111",
				"0101000101010001111111110001000100001111000000001111111111111111",
				"1010000010100000111111110001000100001111000000001111111111111111",
				"0101000101010001111111110001000100001111000000001111111111111111",
				"1010001101010001111111110001000100001111000000001111111111111111",
				"0101011101010001111111110001000100001111000000001111111111111111",
				"1010111101010001111111110001000100001111000000001111111111111111",
				"0101011101010001111111110001000100001111000000001111111111111111",
				"1010001101010001111111110001000100001111000000001111111111111111",
				"0101000101010001111111110001000100001111000000001111111111111111",
				"1010000010100000111111110001000100001111000000001111111111111111",
				"0101000101010001111111110001000100001111000000001111111111111111",
				"1010001101010001111111110001000100001111000000001111111111111111",
				"0101011101010001111111110001000100001111000000001111111111111111",
				"1010111101010001111111110001000100001111000000001111111111111111",
				"0101011101010001111111110001000100001111000000001111111111111111",
				"1010001101010001111111110001000100001111000000001111111111111111",
				"0101000101010001111111110001000100001111000000001111111111111111",
				"1010000010100000111111110001000100001111000000001111111111111111",
				"0101000101010001111111110001000100001111000000001111111111111111",
				"1010001101010001111111110001000100001111000000001111111111111111",
				"0101011101010001111111110001000100001111000000001111111111111111",
				"1010111101010001111111110001000100001111000000001111111111111111",
				"0101011101010001111111110001000100001111000000001111111111111111",
				"1010001101010001111111110001000100001111000000001111111111111111",
				"0101000101010001111111110001000100001111000000001111111111111111",
				"1010000010100000111111110001000100001111000000001111111111111111",
				"0101000101010001111111110001000100001111000000001111111111111111",
				"1010001101010001111111110001000100001111000000001111111111111111",
				"0101011101010001111111110001000100001111000000001111111111111111",
				"1010111101010001111111110001000100001111000000001111111111111111",
				"0101011101010001111111110001000100001111000000001111111111111111",
				"1010001101010001111111110001000100001111000000001111111111111111",
				"0101000101010001111111110001000100001111000000001111111111111111",
				"1010000010100000111111110001000100001111000000001111111111111111",
				"0101000101010001111111110001000100001111000000001111111111111111",
				"1010001101010001111111110001000100001111000000001111111111111111",
				"0101011101010001111111110001000100001111000000001111111111111111",
				"1010111101010001111111110001000100001111000000001111111111111111",
				"0101011101010001111111110001000100001111000000001111111111111111",
				"1010001101010001111111110001000100001111000000001111111111111111",
				"0101000101010001111111110001000100001111000000001111111111111111",
				"1010000010100000111111110001000100001111000000001111111111111111",
				"0101000101010001111111110001000100001111000000001111111111111111",
				"1010001101010001111111110001000100001111000000001111111111111111",
				"0101011101010001111111110001000100001111000000001111111111111111",
				"1010111101010001111111110001000100001111000000001111111111111111",
				"0101011101010001111111110001000100001111000000001111111111111111",
				"1010001101010001111111110001000100001111000000001111111111111111",
				"0101000101010001111111110001000100001111000000001111111111111111",
				"1010000010100000111111110001000100001111000000001111111111111111",
		}));
	}

	static int solve(String[] rows) {
		return solve(0, 0, rows.length, rows);
	}

	public static final int[][] QUADRANTS = new int[][]{{0, 0}, {1, 0}, {0, 1}, {1, 1}};
	public static final int INFINITY = 100000000;

	static int solve(int x, int y, int w, String[] rows) {
		if (w == 1) {
			return 0;
		}

		int newW = w / 2;

		int result = INFINITY;
		for (int[] dxyw : QUADRANTS) {
			for (int[] dxyb : QUADRANTS) {
				if (dxyb != dxyw) {
					int currResult = diff(x + (dxyb[0] * newW), y + (dxyb[1] * newW), newW, rows, '0');
					currResult += diff(x + (dxyw[0] * newW), y + (dxyw[1] * newW), newW, rows, '1');
					for (int[] d1 : QUADRANTS) {
						if ((d1 != dxyb) && (d1 != dxyw)) {
							currResult += solve(x + (d1[0] * newW), y + (d1[1] * newW), newW, rows);
						}
					}
					result = Math.min(result, currResult);
				}
			}
		}
		return result;
	}

	static int diff(int x, int y, int w, String[] rows, char col) {
		int result = 0;
		for (int i = x; i < (x + w); i++) {
			for (int j = y; j < (y + w); j++) {
				if (rows[i].charAt(j) != col) {
					result++;
				}
			}
		}
		return result;
	}
}